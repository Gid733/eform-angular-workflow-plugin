<eform-subheader [title]="'Edit workflow case' | translate"> </eform-subheader>

<div class="container-fluid">
  <div class="row">
    <div class="col-md-9">
      <mdb-card class="sticky-top mb-4 mt-4" style="z-index: 1">
        <mdb-card-header
        ><p class="h4">{{ 'Edit workflow case' | translate }}</p>
        </mdb-card-header>
        <mdb-card-body>
          <div class="container-fluid">
            <div class="row">
              <mdb-card class="mb-4 mt-4" style="width: 100%;">
                <mdb-card-header style="background-color: rgb(232, 234, 246);">{{
                  'Date of incident' | translate
                  }}</mdb-card-header>
                <mdb-card-body>
                  <div class="md-form md-form-case-elem" [owlDateTimeTrigger]="dateOfIncidentPicker">
                    <div class="md-form" [owlDateTimeTrigger]="dateOfIncidentPicker">
                      <i class="material-icons prefix">calendar_today</i>
                      <input mdbInput
                             [owlDateTime]="dateOfIncidentPicker"

                             [ngModel]="workflowCaseModel.dateOfIncident"
                             type="text"
                             id="startDate"
                             name="startDate"
                             class="form-control">
                      <label for="startDate">{{'Start date*' | translate}}</label>
                      <owl-date-time
                        [pickerType]="'calendar'" #dateOfIncidentPicker></owl-date-time>
                    </div>
                  </div>
                </mdb-card-body>
              </mdb-card>
            </div>
            <div class="row">
              <mdb-card class="mb-4 mt-4" style="width: 100%">
                <mdb-card-header style="background-color: rgb(232, 234, 246);">{{ 'Incident type' | translate }}</mdb-card-header>
                <mdb-card-body>
                  <ng-select
                    id="incidentTypeEdit"
                    [bindLabel]="'name'"
                    [bindValue]="'id'"
                    [clearable]="false"
                    [(ngModel)]="workflowCaseModel.incidentType"
                    [items]="incidentTypes"
                  ></ng-select>
                </mdb-card-body>
              </mdb-card>
            </div>
            <div class="row">
              <mdb-card class="mb-4 mt-4" style="width: 100%">
                <mdb-card-header style="background-color: rgb(232, 234, 246);">{{ 'Location of incident' | translate }}</mdb-card-header>
                <mdb-card-body>
                  <ng-select
                    id="placeEdit"
                    [bindLabel]="'name'"
                    [bindValue]="'id'"
                    [clearable]="false"
                    [(ngModel)]="workflowCaseModel.incidentPlace"
                    [items]="places"
                  ></ng-select>
                </mdb-card-body>
              </mdb-card>
            </div>

            <div class="row">
              <mdb-card class="mb-4 mt-4" style="width: 100%">
                <mdb-card-header style="background-color: rgb(232, 234, 246);">{{
                  'Pictures' | translate
                  }}</mdb-card-header>
                <mdb-card-body *ngIf="workflowCaseModel.picturesOfTask">
                  <element-picture [fieldValues]="workflowCaseModel.picturesOfTask"></element-picture>
                </mdb-card-body>
              </mdb-card>
            </div>

            <div class="row">
              <mdb-card class="mb-4 mt-4" style="width: 100%">
                <mdb-card-header style="background-color: rgb(232, 234, 246);">{{
                  'Description' | translate
                  }}</mdb-card-header>
                <mdb-card-body>
                  <div class="md-form">
                    <pell-editor
                      id="descriptionEdit"
                      [(value)]="workflowCaseModel.description"
                    ></pell-editor>
                  </div>
                </mdb-card-body>
              </mdb-card>
            </div>

            <div class="row">
              <mdb-card class="mb-4 mt-4" style="width: 100%">
                <mdb-card-header style="background-color: rgb(255, 228, 228);">{{
                  'ALL FIELDS IN RED TO BE FILLED BY MANAGEMENT' | translate
                  }}</mdb-card-header>
              </mdb-card>
            </div>
            <div class="row">
              <mdb-card class="mb-4 mt-4" style="width: 100%">
                <mdb-card-header style="background-color: rgb(255, 228, 228);">{{
                  'Select deadline' | translate
                  }}</mdb-card-header>
                <mdb-card-body>

                  <div class="md-form md-form-case-elem" [owlDateTimeTrigger]="deadlinePicker">
                    <div class="md-form" [owlDateTimeTrigger]="deadlinePicker">
                      <i class="material-icons prefix">calendar_today</i>
                      <input mdbInput
                             [owlDateTime]="deadlinePicker"

                             [ngModel]="workflowCaseModel.deadline"
                             type="text"
                             id="deadline"
                             name="deadline"
                             class="form-control">
                      <label for="startDate">{{'Start date*' | translate}}</label>
                      <owl-date-time
                        [pickerType]="'calendar'" #deadlinePicker></owl-date-time>
                    </div>
                  </div>
                </mdb-card-body>
              </mdb-card>
            </div>
            <div class="row">
              <mdb-card class="mb-4 mt-4" style="width: 100%">
                <mdb-card-header style="background-color: rgb(255, 228, 228);">{{
                  'Action plan' | translate
                  }}</mdb-card-header>
                <mdb-card-body>
                  <div class="md-form">
                    <pell-editor
                      id="actionPlanEdit"
                      [(value)]="workflowCaseModel.actionPlan"
                    ></pell-editor>
                  </div>
                </mdb-card-body>
              </mdb-card>
            </div>
            <div class="row">
              <mdb-card class="mb-4 mt-4" style="width: 100%">
                <mdb-card-header style="background-color: rgb(255, 228, 228);">{{
                  'To be solved by' | translate
                  }}</mdb-card-header>
                <mdb-card-body>
                  <ng-select
                    id="toBeSolvedByEdit"
                    [bindLabel]="'siteName'"
                    [bindValue]="'id'"
                    [clearable]="false"
                    [(ngModel)]="workflowCaseModel.toBeSolvedById"
                    [items]="deviceUsersList"
                  ></ng-select>
                </mdb-card-body>
              </mdb-card>
            </div>
            <div class="row">
              <mdb-card class="mb-4 mt-4" style="width: 100%">
                <mdb-card-header style="background-color: rgb(255, 228, 228);">{{ 'Status' | translate }}</mdb-card-header>
                <mdb-card-body>
                  <ng-select
                    id="statusEdit"
                    [bindLabel]="'text'"
                    [bindValue]="'id'"
                    [clearable]="false"
                    [(ngModel)]="workflowCaseModel.status"
                    [items]="statuses"
                  ></ng-select>
                </mdb-card-body>
              </mdb-card>
            </div>
          </div>
        </mdb-card-body>
      </mdb-card>
    </div>
    <div class="col-md-3">
      <mdb-card class="sticky-top mb-4 mt-4" style="z-index: 1">
        <mdb-card-footer>
          <div
            class="d-flex justify-content-center align-items-center flex-column mt-2"
          >
            <div>
              <button
                mdbBtn
                class="btn-success btn-small-height"
                id="saveEditBtn"
                (click)="updateWorkflowCase()"
              >
                {{ 'Save' | translate }}
              </button>
              <button
                mdbBtn
                id="cancelEditBtn"
                class="btn btn-accent text-black-50 btn-small-height"
                (click)="goBack()"
              >
                {{ 'Cancel' | translate }}
              </button>
            </div>
          </div>
        </mdb-card-footer>
      </mdb-card>
    </div>
  </div>
</div>

<owl-date-time
  [pickerType]="'calendar'"
  [firstDayOfWeek]="1"
  #deadlinePicker
></owl-date-time>

<owl-date-time
  [pickerType]="'calendar'"
  [firstDayOfWeek]="1"
  #dateOfIncidentPicker
></owl-date-time>
